<script>
  const BASE = `${location.origin}`;
  const categories = [
    "404","Benefits___Statistics","CTA___Banner","Calendar","Courses","Dashboard","FAQ",
    "Features","Footer","Form___Survey___Quiz","Forums___Discussion","Gallery","Hero",
    "Integrations","Menu-Nav","Password","Payment","Popup","Profile",
    "Registration___Progress_Steps","Reviews","Services","Tables","Team","Testimonials",
    "Upload___Download"
  ];

  const catSel = document.getElementById("category");
  const devSel = document.getElementById("device");
  const modeSel = document.getElementById("mode");
  const gallery = document.getElementById("gallery");
  const loading = document.getElementById("loading");

  categories.forEach(c => catSel.add(new Option(c, c)));

  function getFilePrefix(cat) {
    return cat === "404" ? "404_Error_Blocks" : `${cat}_Blocks`;
  }

  function loadImages() {
    const cat = catSel.value;
    const dev = devSel.value;
    const mode = modeSel.value;
    const prefix = getFilePrefix(cat);

    gallery.innerHTML = "";
    loading.style.display = "flex";

    const fragment = document.createDocumentFragment();

    for (let i = 1; i <= 120; i++) {
      const img = new Image();
      img.loading = "lazy";
      img.decoding = "async";
      // âœ… Removed the "public" prefix
      img.src = `${BASE}/${cat}/${dev}/${mode}/${prefix}-${i}_result.webp`;
      img.alt = `${cat} block`;
      img.onerror = () => img.remove();
      img.className = "block-card w-full rounded-xl shadow hover:scale-[1.02]";
      fragment.appendChild(img);
    }

    gallery.appendChild(fragment);
    loading.style.display = "none";
  }

  catSel.onchange = loadImages;
  devSel.onchange = loadImages;
  modeSel.onchange = loadImages;

  catSel.value = "404";
  loadImages();
</script>
